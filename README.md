# Light Field Super-Resolution with Zero-Shot Learning

**Official implementation** of the following paper

Zhen Cheng, Zhiwei Xiong, Chang Chen, Dong Liu, and Zheng-Jun Zha, [Light Field Super-Resolution with Zero-Shot Learning](https://openaccess.thecvf.com/content/CVPR2021/html/Cheng_Light_Field_Super-Resolution_With_Zero-Shot_Learning_CVPR_2021_paper.html). In CVPR 2021. (Oral)



[Paper](https://openaccess.thecvf.com/content/CVPR2021/papers/Cheng_Light_Field_Super-Resolution_With_Zero-Shot_Learning_CVPR_2021_paper.pdf) | [Supplementary Material](https://openaccess.thecvf.com/content/CVPR2021/supplemental/Cheng_Light_Field_Super-Resolution_CVPR_2021_supplemental.pdf) | [Bibtex](https://github.com/Joechann0831/LFZSSR#citation)



## Dependencies

- Python 3 (Recommend to use [Anaconda](https://www.anaconda.com/download/#linux))
- Pytorch 1.0.0
- Numpy
- Scipy
- TensorboardX
- MATLAB (For data preparation)



## Usage

### 1. Preparation

- We make experiments on the luminance channel which could generated by MATLAB function [rgb2ycbcr](https://www.mathworks.com/help/images/ref/rgb2ycbcr.html).
- Download our processed data from [Data Download](https://rec.ustc.edu.cn/share/05666600-e236-11eb-b369-21bab896b967) (Access code: isve) and put them in the folder data. 
- Download our pre-trained model from [Pretrain Model](https://rec.ustc.edu.cn/share/82899500-e236-11eb-883c-73e9a609fb67) (Access code: w5ld) and put them in the folder pretrain.



### 2. Zero-shot learning from scratch

Take scene *Spear_Fence_2* in dataset *EPFL* with scaling factor 2 as an example.

```shell
python Main_LFZSSR.py --dataset="EPFL" --start=2 --end=3 --scale=2 --record
```

You can refer to the script [Main_LFZSSR.py](https://github.com/Joechann0831/LFZSSR/blob/master/Main_LFZSSR.py) to know the meaning of each parameter. 

### 3. Error-guided finetuning

Our error-guided finetuning needs a pre-trained model for initialization and error map generation, please download our pre-trained models

Take scene *Spear_Fence_2* in dataset *EPFL* with scaling factor 2 and source dataset *HFUT* as an example.

```shell
python Main_error_guided_finetuning.py --dataset="EPFL" --start=2 --end=3 --scale=2 --source="HFUT" --record
```

You can refer to the script [Main_error_guided_finetuning.py](https://github.com/Joechann0831/LFZSSR/blob/master/Main_error_guided_finetuning.py) to know the meaning of each parameter.

### 4. Hyper-parameters

We set the hyper-parameters during training and testing after tuning on our testing data, if you want to use our algorithm on your own data, please refer to [Hyper-parameters](https://github.com/Joechann0831/LFZSSR/blob/master/hyper-parameters/hyperparameters.md) for detailed descriptions of each hyper-parameter.

## Citation

If you find this work helpful, please consider citing our paper.

```latex
@InProceedings{Cheng_2021_CVPR,
    author    = {Cheng, Zhen and Xiong, Zhiwei and Chen, Chang and Liu, Dong and Zha, Zheng-Jun},
    title     = {Light Field Super-Resolution With Zero-Shot Learning},
    booktitle = {Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition (CVPR)},
    month     = {June},
    year      = {2021},
    pages     = {10010-10019}
}
```

## Related Projects

[Light field depth estimation, LFDEN](https://github.com/JiayongO-O/LFDEN)

[ZSSR](https://github.com/assafshocher/ZSSR)

## Contact

If you have any problems about the released code, please do not hesitate to contact me with email (mywander@mail.ustc.edu.cn).